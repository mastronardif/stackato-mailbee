<html><head><title>Perl::Critic::DEVELOPER</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.012001 at Wed Apr 13 00:04:28 2011 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#BACKGROUND'>BACKGROUND</a>
  <li class='indexItem indexItem1'><a href='#EXAMPLE_POLICY'>EXAMPLE POLICY</a>
  <li class='indexItem indexItem1'><a href='#MAKING_YOUR_POLICY_CONFIGURABLE'>MAKING YOUR POLICY CONFIGURABLE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Do_It_All_Yourself'>Do It All Yourself</a>
    <li class='indexItem indexItem2'><a href='#Note_On_Constructors'>Note On Constructors</a>
    <li class='indexItem indexItem2'><a href='#Providing_Basic_Configuration_Information_Via_supported_parameters()'>Providing Basic Configuration Information Via supported_parameters()</a>
    <li class='indexItem indexItem2'><a href='#Using_supported_parameters()_to_Get_It_Done_For_You'>Using supported_parameters() to Get It Done For You</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#%22string%22'>&#34;string&#34;</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#supported_parameters()_example'>supported_parameters() example</a>
        <li class='indexItem indexItem4'><a href='#Access_example'>Access example</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#%22boolean%22'>&#34;boolean&#34;</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#supported_parameters()_example'>supported_parameters() example</a>
        <li class='indexItem indexItem4'><a href='#Access_example'>Access example</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#%22integer%22'>&#34;integer&#34;</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#supported_parameters()_example'>supported_parameters() example</a>
        <li class='indexItem indexItem4'><a href='#Access_example'>Access example</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#%22string_list%22'>&#34;string list&#34;</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#supported_parameters()_example'>supported_parameters() example</a>
        <li class='indexItem indexItem4'><a href='#Access_example'>Access example</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#%22enumeration%22'>&#34;enumeration&#34;</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#supported_parameters()_example'>supported_parameters() example</a>
        <li class='indexItem indexItem4'><a href='#Access_example'>Access example</a>
      </ul>
    </ul>
    <li class='indexItem indexItem2'><a href='#Using_a_Custom_Parser'>Using a Custom Parser</a>
    <li class='indexItem indexItem2'><a href='#Using_Both_supported_parameters()_and_initialize_if_enabled()'>Using Both supported_parameters() and initialize_if_enabled()</a>
    <li class='indexItem indexItem2'><a href='#Summary_of_permitted_hash_keys_in_supported_parameters().'>Summary of permitted hash keys in supported_parameters().</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#All_types'>All types</a>
      <li class='indexItem indexItem3'><a href='#Enumerations'>Enumerations</a>
      <li class='indexItem indexItem3'><a href='#Integers'>Integers</a>
      <li class='indexItem indexItem3'><a href='#String_lists'>String lists</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#ADDITIONAL_FEATURES'>ADDITIONAL FEATURES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#default_maximum_violations_per_document()'>default_maximum_violations_per_document()</a>
    <li class='indexItem indexItem2'><a href='#is_safe()'>is_safe()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#DISTRIBUTING_YOUR_POLICIES'>DISTRIBUTING YOUR POLICIES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Create_a_Distribution'>Create a Distribution</a>
    <li class='indexItem indexItem2'><a href='#Themes'>Themes</a>
    <li class='indexItem indexItem2'><a href='#Documentation'>Documentation</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#AFFILIATION'>AFFILIATION</a>
      <li class='indexItem indexItem3'><a href='#CONFIGURATION'>CONFIGURATION</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#TESTING_YOUR_POLICY'>TESTING YOUR POLICY</a>
  <li class='indexItem indexItem1'><a href='#HINT'>HINT</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Perl::Critic::DEVELOPER - How to make new Perl::Critic::Policy modules.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>For developers who want to create custom coding standards,
the following tells how to create a Policy module for <a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a>.
Although the Perl::Critic distribution already includes a number of Policies based on Damian Conway&#39;s book <i>Perl Best Practices</i> (which will be referred to via &#34;<i>PBP</i>&#34; from here on),
Perl::Critic is not limited to his guidelines and can be used to enforce any practice,
preference,
or style that you want to follow.
You can even write Policies to enforce contradictory guidelines.
All you need to do is write a corresponding <a href="../../Perl/Critic/Policy.html" class="podlinkpod"
>Perl::Critic::Policy</a> subclass,
which may require as little as 10 lines of code.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BACKGROUND"
>BACKGROUND</a></h1>

<p>The heart of Perl::Critic is <a href="../../PPI.html" class="podlinkpod"
>PPI</a>,
a parser and lexer for Perl.
PPI transforms Perl source code into a Document Object Model (DOM).
Each token in the document is represented by a PPI class,
such as <a href="../../PPI/Token/Operator.html" class="podlinkpod"
>PPI::Token::Operator</a> or <a href="../../PPI/Token/Word.html" class="podlinkpod"
>PPI::Token::Word</a>,
and then organized into structure classes,
like <a href="../../PPI/Statement/Expression.html" class="podlinkpod"
>PPI::Statement::Expression</a> and <a href="../../PPI/Structure/Subroutine.html" class="podlinkpod"
>PPI::Structure::Subroutine</a>.
The root node of the hierarchy is the <a href="../../PPI/Document.html" class="podlinkpod"
>PPI::Document</a>.</p>

<p>The <a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a> engine traverses each node in the <a href="../../PPI/Document.html" class="podlinkpod"
>PPI::Document</a> tree and invokes each of the <a href="../../Perl/Critic/Policy.html" class="podlinkpod"
>Perl::Critic::Policy</a> subclasses at the appropriate node.
The Policy can inspect the node,
look at the surrounding nodes,
and do whatever else it wants.
If the Policy decides that that a coding standard has been violated,
it returns one or more <a href="../../Perl/Critic/Violation.html" class="podlinkpod"
>Perl::Critic::Violation</a> objects.
If there are no violations,
then the Policy returns nothing.</p>

<p>Policies are usually written based on existing policies,
so let&#39;s look at one to see how it works.
The <em>RequireBlockGrep.pm</em> Policy is relatively simple and demonstrates most of the important issues.
The goal of this Policy is to enforce that every call to <code>grep</code> uses a block for the first argument and not an expression.
The reasons for this Policy are discussed in detail in <i>PBP</i>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLE_POLICY"
>EXAMPLE POLICY</a></h1>

<p>First,
the Policy module needs to have a name.
Perl::Critic uses <a href="../../Module/Pluggable.html" class="podlinkpod"
>Module::Pluggable</a> to automatically discover all modules in the <code>Perl::Critic::Policy</code> namespace.
Also,
we&#39;ve adopted the convention of grouping Policies into directories according to the chapters of <i>PBP</i>.
Since the goal of this Policy is to enforce the use of block arguments to <code>grep</code> and it comes from the &#34;Builtin Functions&#34; chapter of <i>PBP</i>,
we call it <code>&#34;Perl::Critic::Policy::BuiltinFunctions::RequireBlockGrep&#34;</code>.</p>

<pre>    package Perl::Critic::Policy::BuiltinFunctions::RequireBlockGrep;</pre>

<p>Next, we set some pragmas and load the modules that we&#39;ll need. All Policy modules inherit from the <a href="../../Perl/Critic/Policy.html" class="podlinkpod"
>Perl::Critic::Policy</a> class, which provides no-op implementations of the basic methods. Our job is to override these methods to make them do something useful.</p>

<p>Technically, <code>use strict</code> and <code>use warnings</code> are optional, but we don&#39;t want Perl::Critic to be a hypocrite, now do we?</p>

<pre>    use strict;
    use warnings;

    use Readonly;

    use Perl::Critic::Utils qw{ :severities :classification :ppi };
    use base &#39;Perl::Critic::Policy&#39;;

    our $VERSION = &#39;1.05&#39;;</pre>

<p>Next, we&#39;ll declare a description and explanation for this Policy. The description is always just a string that basically says &#34;this is what&#39;s wrong.&#34; The explanation can be either a string with further details, or a reference to an array of integers that correspond to page numbers in <i>PBP</i>. We make them read-only because they never change. (See <a href="../../Perl/Critic/Policy/ValuesAndExpressions/ProhibitConstantPragma.html" class="podlinkpod"
>Perl::Critic::Policy::ValuesAndExpressions::ProhibitConstantPragma</a> for why we don&#39;t <code>use constant</code>.)</p>

<pre>    Readonly::Scalar my $DESC =&#62; q{Expression form of &#34;grep&#34;};
    Readonly::Scalar my $EXPL =&#62; [ 169 ];</pre>

<p>Most policies don&#39;t need to override the <code>initialize_if_enabled()</code> method provided by <a href="../../Perl/Critic/Policy.html" class="podlinkpod"
>Perl::Critic::Policy</a>. However, if your Policy is configurable via <em>.perlcriticrc</em>, you should implement a <code>supported_parameters()</code> method and need to implement <code>initialize_if_enabled()</code> to examine the <code>$config</code> values. Since this Policy isn&#39;t configurable, we&#39;ll declare that by providing an implementation of <code>supported_parameters()</code> that returns an empty list.</p>

<pre>    sub supported_parameters { return ()                  }</pre>

<p>Next, we define the <code>default_severity()</code> method, which must return an integer indicating the severity of violating this Policy. Severity values range from 1 to 5, where 5 is the &#34;most severe.&#34; In general, level 5 is reserved for things that are frequently misused and/or cause bugs. Level 1 is for things that are highly subjective or purely cosmetic. The <a href="../../Perl/Critic/Utils.html" class="podlinkpod"
>Perl::Critic::Utils</a> package exports several severity constants that you can use here via the <code>:severities</code> tag.</p>

<pre>    sub default_severity     { return $SEVERITY_HIGH      }</pre>

<p>Likewise, the <code>default_themes()</code> method returns a list of theme names. Themes are intended to be named groups of Policies. All Policies that ship with Perl::Critic have a <code>&#34;core&#34;</code> theme. Since use of <code>grep</code> without blocks often leads to bugs, we include a <code>&#34;bugs&#34;</code> theme. And since this Policy comes directly from <i>PBP</i>, this Policy should be a member of the <code>&#34;pbp&#34;</code> theme.</p>

<pre>    sub default_themes       { return qw( core bugs pbp ) }</pre>

<p>As a Policy author, you can assign any themes you want to the Policy. If you&#39;re publishing a suite of custom Policies, we suggest that you create a unique theme that covers all the Policies in the distribution. That way, users can easily enable or disable all of your policies at once. For example, Policies in the <a href="../../Perl/Critic/More.html" class="podlinkpod"
>Perl::Critic::More</a> distribution all have a <code>&#34;more&#34;</code> theme.</p>

<p>Next, we indicate what elements of the code this Policy will analyze, like statements or variables or conditionals or POD. These elements are specified as PPI classes such as <a href="../../PPI/Statement.html" class="podlinkpod"
>PPI::Statement</a>, <a href="../../PPI/Token/Symbol.html" class="podlinkpod"
>PPI::Token::Symbol</a>, <a href="../../PPI/Structure/Conditional.html" class="podlinkpod"
>PPI::Structure::Conditional</a> or <a href="../../PPI/Token/Pod.html" class="podlinkpod"
>PPI::Token::Pod</a> respectively. The <code>applies_to()</code> method returns a list of PPI package names. (You can get that list of available package names via <code>perldoc PPI</code>.) As Perl::Critic traverses the document, it will call the <code>violates()</code> method from this module whenever it encounters one of the PPI types that are given here. In this case, we just want to test calls to <code>grep</code>. Since the token &#34;grep&#34; is a <a href="../../PPI/Token/Word.html" class="podlinkpod"
>PPI::Token::Word</a>, we return that package name from the <code>applies_to()</code> method.</p>

<pre>    sub applies_to           { return &#39;PPI::Token::Word&#39;  }</pre>

<p>If your Policy needs to analyze several different types of elements, the <code>applies_to</code> method may return the name of several PPI packages. If your Policy needs to examine the file as a whole, then the <code>applies_to</code> method should return <a href="../../PPI/Document.html" class="podlinkpod"
>PPI::Document</a>. Since there is only one PPI::Document element, your Policy would only be invoked once per file.</p>

<p>Now comes the interesting part. The <code>violates()</code> method does all the work. It is always called with 2 arguments: a reference to the current PPI element that Perl::Critic is traversing, and a reference to the entire PPI document. [And since this is an object method, there will be an additional argument that is a reference to this object (<code>$self</code>), but you already knew that!] Since this Policy does not need access to the document as a whole, we ignore the last parameter by assigning to <code>undef</code>.</p>

<pre>    sub violates {
        my ( $self, $elem, undef ) = @_;</pre>

<p>The <code>violates()</code> method then often performs some tests to make sure we have the right &#34;type&#34; of element. In our example, we know that the element will be a <a href="../../PPI/Token/Word.html" class="podlinkpod"
>PPI::Token::Word</a> because that&#39;s what we declared back in the <code>applies_to()</code> method. However, we didn&#39;t specify exactly which &#34;word&#34; we were looking for. Evaluating a PPI element in a string context returns the literal form of the code. (You can also use the <code>content()</code> method.) So we make sure that this <code>PPI::Token::Word</code> is, in fact, &#34;grep&#34;. If it&#39;s not, then we don&#39;t need to bother examining it.</p>

<pre>        return if $elem ne &#39;grep&#39;;</pre>

<p>The <code>PPI::Token::Word</code> class is also used for barewords and methods called on object references. It is possible for someone to declare a bareword hash key as <code>%hash = ( grep =&#62; &#39;foo&#39;)</code>. We don&#39;t want to test those types of elements because they don&#39;t represent function calls to <code>grep</code>. So we use one of handy utility functions from <a href="../../Perl/Critic/Utils.html" class="podlinkpod"
>Perl::Critic::Utils</a> to make sure that this &#34;grep&#34; is actually in the right context. (The <code>is_function_call()</code> subroutine is brought in via the <code>:classification</code> tag.)</p>

<pre>        return if ! is_function_call($elem);</pre>

<p>Now that we know this element is a call to the <code>grep</code> function, we can look at the nearby elements to see what kind of arguments are being passed to it. In the following paragraphs, we discuss how to do this manually in order to explore <a href="../../PPI.html" class="podlinkpod"
>PPI</a>; after that, we&#39;ll show how this Policy actually uses facilities provided by <a href="../../Perl/Critic/Utils.html" class="podlinkpod"
>Perl::Critic::Utils</a> to get this done.</p>

<p>Every PPI element is linked to its siblings, parent, and children (if it has any). Since those siblings could just be whitespace, we use the <code>snext_sibling()</code> to get the next code-sibling (the &#34;s&#34; in <code>snext_sibling</code> stands for &#34;significant&#34;).</p>

<pre>        my $sib = $elem-&#62;snext_sibling() or return;</pre>

<p>In Perl, the parenthesis around argument lists are usually optional, and PPI packs the elements into a <a href="../../PPI/Structure/List.html" class="podlinkpod"
>PPI::Structure::List</a> object when parentheses are used. So if the sibling is a <code>PPI::Structure::List</code>, we pull out the first (significant) child of that list. This child will be the first argument to <code>grep</code>. If parentheses were not used, then the sibling itself is the first argument.</p>

<pre>        my $arg = $sib-&#62;isa(&#39;PPI::Structure::List&#39;) ? $sib-&#62;schild(0) : $sib;</pre>

<p>In actuality, this sort of function argument lookup is common, so there is a <a href="../../Perl/Critic/Utils.html#first_arg" class="podlinkpod"
>&#34;first_arg&#34; in Perl::Critic::Utils</a> subroutine available via the <code>:ppi</code> tag. So we use that instead.</p>

<pre>        my $arg = first_arg($elem);</pre>

<p>Finally, we now have a reference to the first argument to <code>grep</code>. If that argument is a block (i.e. something in curly braces), then it will be a <a href="../../PPI/Structure/Block.html" class="podlinkpod"
>PPI::Structure::Block</a>, in which case our Policy is satisfied and we just return nothing.</p>

<pre>        return if !$arg;
        return if $arg-&#62;isa(&#39;PPI::Structure::Block&#39;);</pre>

<p>But if it is not a <a href="../../PPI/Structure/Block.html" class="podlinkpod"
>PPI::Structure::Block</a>, then we know that this call to <code>grep</code> must be using the expression form, and that violates our Policy. So we create and return a new <a href="../../Perl/Critic/Violation.html" class="podlinkpod"
>Perl::Critic::Violation</a> object via the <a href="../../Perl/Critic/Policy.html#violation" class="podlinkpod"
>&#34;violation&#34; in Perl::Critic::Policy</a> method, passing in the description, explanation, and a reference to the PPI element that caused the violation. And that&#39;s all there is to it!</p>

<pre>        return $self-&#62;violation( $DESC, $EXPL, $elem );
    }

    1;</pre>

<p>One last thing -- people are going to need to understand what is wrong with the code when your Policy finds a problem. It isn&#39;t reasonable to include all the details in your violation description or explanation. So please include a DESCRIPTION section in the POD for your Policy. It should succinctly describe the behavior and motivation for your Policy and include a few examples of both good and bad code. Here&#39;s an example:</p>

<pre>    =pod

    =head1 NAME

    Perl::Critic::Policy::BuiltinFunctions::RequireBlockGrep


    =head1 DESCRIPTION

    The expression forms of C&#60;grep&#62; and C&#60;map&#62; are awkward and hard to read.
    Use the block forms instead.

        @matches = grep  /pattern/,    @list;        #not ok
        @matches = grep { /pattern/ }  @list;        #ok

        @mapped = map  transform($_),    @list;      #not ok
        @mapped = map { transform($_) }  @list;      #ok

    =cut</pre>

<p>When your policy has a section like this, users can invoke <a href="../../perlcritic.html" class="podlinkpod"
>perlcritic</a> with a <code>--verbose</code> parameter of <code>10</code> or <code>11</code> or with a &#34;%d&#34; escape to see it along with the rest of the output for violations of your policy.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="MAKING_YOUR_POLICY_CONFIGURABLE"
>MAKING YOUR POLICY CONFIGURABLE</a></h1>

<p><a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a> takes care of gathering configuration information for your Policy, from whatever source the user specifies. (See <a href="../../Perl/Critic.html#CONFIGURATION" class="podlinkpod"
>&#34;CONFIGURATION&#34; in Perl::Critic</a> for the details of how a user specifies the values you&#39;re going to receive.) What your Policy ends up receiving for the value of a parameter is a string with leading and trailing whitespace removed. By default, you will need to handle conversion of that string to a useful form yourself. However, if you provide some metadata about your parameters, the parameter handling will be taken care of for you. (Additionally, tools that deal with Policies themselves can use this information to enhance their functionality. See the <a href="../../perlcritic.html" class="podlinkpod"
>perlcritic</a> <code>--profile-proto</code> option for an example.)</p>

<p>You can look at <a href="../../Perl/Critic/Policy/ControlStructures/ProhibitCascadingIfElse.html" class="podlinkpod"
>Perl::Critic::Policy::ControlStructures::ProhibitCascadingIfElse</a> for a simple example of a configurable Policy and <a href="../../Perl/Critic/Policy/Documentation/RequirePodSections.html" class="podlinkpod"
>Perl::Critic::Policy::Documentation::RequirePodSections</a> for a more complex one.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Do_It_All_Yourself"
>Do It All Yourself</a></h2>

<p>The <code>initialize_if_enabled()</code> method for a Policy receives one argument: an instance of <a href="../../Perl/Critic/PolicyConfig.html" class="podlinkpod"
>Perl::Critic::PolicyConfig</a>. This method is only called if the user&#39;s configuration has enabled the policy. It returns a boolean stating whether the Policy should continue to be enabled. Generally, the only reason to return <code>$FALSE</code> is when some external requirement is missing. For example, <a href="../../Perl/Critic/Policy/CodeLayout/RequireTidyCode.html" class="podlinkpod"
>Perl::Critic::Policy::CodeLayout::RequireTidyCode</a> used to disable itself if <a href="../../Perl/Tidy.html" class="podlinkpod"
>Perl::Tidy</a> was not installed (that is until we made it no longer optional for the Perl-Critic distribution).</p>

<p>A basic, do-nothing implementation of <code>initialize_if_enabled()</code> would be:</p>

<pre>    use Perl::Critic::Utils qw&#60; :booleans &#62;;

    ...

    sub initialize_if_enabled {
        my ( $self, $config ) = @_;

        return $TRUE;
    }</pre>

<p>As stated above, what you get in <code>$config</code> are trimmed strings. For example, if the user&#39;s <em>.perlcritic</em> contains</p>

<pre>    [Your::Policy]
    foo          = bar baz
    factor   =     5.52
    selections =   2 78 92</pre>

<p>then <code>$config</code> will contain the equivalent of</p>

<pre>    my $config = {
        foo        =&#62; &#39;bar baz&#39;,
        factor     =&#62; &#39;5.52&#39;,
        selections =&#62; &#39;2 78 92&#39;,
    };</pre>

<p>To make this available to the <code>violates()</code> method, the values are usually put into <code>$self</code> under the name of the configuration item prefixed with an underscore. E.g.</p>

<pre>    sub initialize_if_enabled {
        my ( $self, $config ) = @_;

        $self-&#62;{_foo} = $config-&#62;get{foo};
        $self-&#62;{_factor} = $config-&#62;get{factor};
        $self-&#62;{_selections} = $config-&#62;get{selections};

        return $TRUE;
    }</pre>

<p>Often, you&#39;ll want to convert the configuration values into something more useful. In this example, <code>selections</code> is supposed to be a list of integers. <a href="../../Perl/Critic/Utils.html" class="podlinkpod"
>Perl::Critic::Utils</a> contains a number of functions that can help you with this. Assuming that <code>violates()</code> wants to have <code>selections</code> as an array, you&#39;ll want to have something like this:</p>

<pre>    use Perl::Critic::Utils qw{ :booleans :characters :data_conversion };

    sub initialize_if_enabled {
        my ( $self, $config ) = @_;

        $self-&#62;{_foo} = $config-&#62;get{foo};
        $self-&#62;{_factor} = $config-&#62;get{factor};

        my $selections = $config-&#62;get{selections};
        $selections = defined $selections ? $selections : $EMPTY_STRING;
        $self-&#62;{_selections} = [ words_from_string($selections) ];

        return $TRUE;
    }</pre>

<p>Since <code>selections</code> contains numbers, it may be desirable to change the assignment to look like</p>

<pre>    $self-&#62;{_selections} = [ map { $_ + 0 } words_from_string($selections) ];</pre>

<p>If <code>violates()</code> needs to quickly determine whether a particular value is in <code>selections</code>, you would want to use a hash instead of an array, like this:</p>

<pre>    $self-&#62;{_selections} = { hashify( words_from_string($selections) ) };</pre>

<p>For an example of a Policy that has some simple, but non-standard configuration handling, see <a href="../../Perl/Critic/Policy/CodeLayout/RequireTidyCode.html" class="podlinkpod"
>Perl::Critic::Policy::CodeLayout::RequireTidyCode</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Note_On_Constructors"
>Note On Constructors</a></h2>

<p>It used to be the case that Policies handled configuration by implementing a constructor. However, there was no requirement to call the base constructor; as long as the Policy ended up being a blessed hash reference, everything was fine. Unfortunately, this meant that Policies would be loaded and their prerequisites would be <code>use</code>d, even if the Policy wasn&#39;t enabled, slowing things down. Also, this severely restricted the core of <a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a>&#39;s ability to enhance things. Use of constructors is deprecated and is incompatible with <code>supported_parameters()</code> metadata below. Kindly use <code>initialize_if_enabled()</code>, instead, to do any sort of set up that you need.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Providing_Basic_Configuration_Information_Via_supported_parameters()"
>Providing Basic Configuration Information Via <code>supported_parameters()</code></a></h2>

<p>As minimum for a well behaved Policy, you should implement <code>supported_parameters()</code> in order to tell the rest of <code>Perl::Critic</code> what configuration values the Policy looks for, even if it is only to say that the Policy is not configurable. In the simple form, this function returns a list of the names of the parameters the Policy supports. So, for an non-configurable Policy, as in the <code>RequireBlockGrep</code> example above, this looked like</p>

<pre>    sub supported_parameters { return ()                  }</pre>

<p>For the example being used in the <code>initialize_if_enabled()</code> section above, this would be</p>

<pre>    sub supported_parameters { return qw&#60; foo factor selections &#62;; }</pre>

<p>Given this information, <code>Perl::Critic</code> can tell the user when they have specified a parameter for a Policy which isn&#39;t valid, e.g. when they&#39;ve misspelled the name of the parameter, and can emit the parameter as part of a <em>.perlcriticrc</em> prototype.</p>

<p>You can provide even more information about your Policy&#39;s configuration by giving each parameter a description and a string representation of the default value for the parameter. You do this by having the values in the list returned by <code>supported_parameters()</code> be hash references instead of strings, with keys of <code>name</code>, <code>description</code>, and <code>default_string</code>. For example,</p>

<pre>    sub supported_parameters {
        return (
            {
                name           =&#62; &#39;allowed_values&#39;,
                description    =&#62;
                    &#39;Individual and ranges of values to allow, and/or &#34;all_integers&#34;.&#39;,
                default_string =&#62; &#39;0 1 2&#39;,
            },
            {
                name           =&#62; &#39;allowed_types&#39;,
                description    =&#62; &#39;Kind of literals to allow.&#39;,
                default_string =&#62; &#39;Float&#39;,
            },
        );
    }</pre>

<p>Note that use of constructors is <a href="#Note_On_Constructors" class="podlinkpod"
>incompatible</a> with specifying parameters in this way.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Using_supported_parameters()_to_Get_It_Done_For_You"
>Using <code>supported_parameters()</code> to Get It Done For You</a></h2>

<p>The <code>supported_parameters()</code> discussion above showed how you could help others with your Policy, but didn&#39;t do anything to make your life as a Policy author easier; you still need to implement <code>initialize_if_enabled()</code> to access any configuration that the user has specified. To have the configuration automatically handled for you, you need to declare how your parameters act by specifying a value for their <code>behavior</code>. For example, the following declares that a parameter allows the user to choose from five specific values and that the user can select any combination of them:</p>

<pre>    sub supported_parameters {
        return (
            {
                name               =&#62; &#39;allowed_types&#39;,
                description        =&#62; &#39;Kind of literals to allow.&#39;,
                default_string     =&#62; &#39;Float&#39;,
                behavior           =&#62; &#39;enumeration&#39;,
                enumeration_values =&#62; [ qw{ Binary Exp Float Hex Octal } ],
                enumeration_allow_multiple_values =&#62; 1,
            },
        );
    }</pre>

<p>When you specify a behavior, parsing and validation of the user-specified and default values is done for you and your <code>violates()</code> method can retrieve the value under the key of the parameter name prefixed with an underscore, e.g., for the above declaration, the parsed and validated value can be accessed via <code>$self-&#62;{_allowed_types}</code>.</p>

<p>The behaviors provide additional functionality to <code>Perl::Critic</code>; for more on this, see <a href="../../Perl/Critic/PolicyParameter.html" class="podlinkpod"
>Perl::Critic::PolicyParameter</a> and <a href="../../Perl/Critic/PolicyParameter/Behavior.html" class="podlinkpod"
>Perl::Critic::PolicyParameter::Behavior</a>.</p>

<p>The following discusses each of the supported behaviors and the options they support. For the full details of a behavior, see the documentation for the implementing class.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="&#34;string&#34;"
>&#34;string&#34;</a></h3>

<p>Implemented in <a href="../../Perl/Critic/PolicyParameter/Behavior/String.html" class="podlinkpod"
>Perl::Critic::PolicyParameter::Behavior::String</a>.</p>

<p>The most basic of behaviors, the value of the parameter will be stored in the Policy as a string.</p>

<p>This behavior is not configurable.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="supported_parameters()_example"
><code>supported_parameters()</code> example</a></h4>

<pre>    sub supported_parameters {
        return (
            {
                name           =&#62; &#39;a_string&#39;,
                description    =&#62; &#39;An example string.&#39;,
                default_string =&#62; &#39;blah blah blah&#39;,
                behavior       =&#62; &#39;string&#39;,
            },
        );
    }</pre>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Access_example"
>Access example</a></h4>

<pre>    sub violates {
        my ($self, $element, $document) = @_;

        ...
        my $string = $self-&#62;{_a_string};
        ...
    }</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="&#34;boolean&#34;"
>&#34;boolean&#34;</a></h3>

<p>Implemented in <a href="../../Perl/Critic/PolicyParameter/Behavior/Boolean.html" class="podlinkpod"
>Perl::Critic::PolicyParameter::Behavior::Boolean</a>.</p>

<p>The value of the parameter will be either <a href="../../Perl/Critic/Utils.html#%24TRUE" class="podlinkpod"
>$TRUE</a> or <a href="../../Perl/Critic/Utils.html#%24FALSE" class="podlinkpod"
>$FALSE</a>.</p>

<p>This behavior is not configurable.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="supported_parameters()_example"
><code>supported_parameters()</code> example</a></h4>

<pre>    sub supported_parameters {
        return (
            {
                name           =&#62; &#39;a_boolean&#39;,
                description    =&#62; &#39;An example boolean.&#39;,
                default_string =&#62; &#39;1&#39;,
                behavior       =&#62; &#39;boolean&#39;,
            },
        );
    }</pre>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Access_example"
>Access example</a></h4>

<pre>    sub violates {
        my ($self, $element, $document) = @_;

        ...
        my $is_whatever = $self-&#62;{_a_boolean};
        if ($is_whatever) {
            ...
        }
        ...
    }</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="&#34;integer&#34;"
>&#34;integer&#34;</a></h3>

<p>Implemented in <a href="../../Perl/Critic/PolicyParameter/Behavior/Integer.html" class="podlinkpod"
>Perl::Critic::PolicyParameter::Behavior::Integer</a>.</p>

<p>The value is validated against <code>m/ \A [-+]? [1-9] [\d_]* \z /xms</code> (with an special check for &#34;0&#34;). Notice that this means that underscores are allowed in input values as with Perl numeric literals.</p>

<p>This takes two options, <code>integer_minimum</code> and <code>integer_maximum</code>, which specify endpoints of an inclusive range to restrict the value to. Either, neither, or both may be specified.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="supported_parameters()_example"
><code>supported_parameters()</code> example</a></h4>

<pre>    sub supported_parameters {
        return (
            {
                name            =&#62; &#39;an_integer&#39;,
                description     =&#62; &#39;An example integer.&#39;,
                default_string  =&#62; &#39;5&#39;,
                behavior        =&#62; &#39;integer&#39;,
                integer_minimum =&#62; 0,
                integer_maximum =&#62; 10,
            },
        );
    }</pre>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Access_example"
>Access example</a></h4>

<pre>    sub violates {
        my ($self, $element, $document) = @_;

        ...
        my $integer = $self-&#62;{_an_integer};
        if ($integer &#62; $TURNING_POINT) {
            ...
        }
        ...
    }</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="&#34;string_list&#34;"
>&#34;string list&#34;</a></h3>

<p>Implemented in <a href="../../Perl/Critic/PolicyParameter/Behavior/StringList.html" class="podlinkpod"
>Perl::Critic::PolicyParameter::Behavior::StringList</a>.</p>

<p>The values will be derived by splitting the input string on blanks. (See <a href="../../Perl/Critic/Utils.html#words_from_string" class="podlinkpod"
>&#34;words_from_string&#34; in Perl::Critic::Utils</a>.) The parameter will be stored as a reference to a hash, with the values being the keys.</p>

<p>This takes one optional option, <code>list_always_present_values</code>, of a reference to an array of strings that will always be included in the parameter value, e.g. if the value of this option is <code>[ qw{ a b c } ]</code> and the user specifies a value of <code>&#39;c d e&#39;</code>, then the value of the parameter will contain <code>&#39;a&#39;</code>, <code>&#39;b&#39;</code>, <code>&#39;c&#39;</code>, <code>&#39;d&#39;</code>, and <code>&#39;e&#39;</code>.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="supported_parameters()_example"
><code>supported_parameters()</code> example</a></h4>

<pre>    sub supported_parameters {
        return (
            {
                name                  =&#62; &#39;a_string_list&#39;,
                description           =&#62; &#39;An example list.&#39;,
                default_string        =&#62; &#39;red pink blue&#39;,
                behavior              =&#62; &#39;string list&#39;,
                list_always_present_values =&#62; [ qw{ green purple} ],
            },
        );
    }</pre>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Access_example"
>Access example</a></h4>

<pre>    sub violates {
        my ($self, $element, $document) = @_;

        ...
        my $list = $self-&#62;{_a_string_list};
        my @list = keys %{$list};
        ...
        return if not $list-&#62;{ $element-&#62;content() };
        ...
    }</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="&#34;enumeration&#34;"
>&#34;enumeration&#34;</a></h3>

<p>Implemented in <a href="../../Perl/Critic/PolicyParameter/Behavior/Enumeration.html" class="podlinkpod"
>Perl::Critic::PolicyParameter::Behavior::Enumeration</a>.</p>

<p>The values will be derived by splitting the input string on blanks. (See <a href="../../Perl/Critic/Utils.html#words_from_string" class="podlinkpod"
>&#34;words_from_string&#34; in Perl::Critic::Utils</a>.) Depending upon the value of the <code>enumeration_allow_multiple_values</code> option, the parameter will be stored as a string or a reference to a hash, with the values being the keys.</p>

<p>This behavior takes one required option and one optional one. A value for <code>enumeration_values</code> of a reference to an array of valid strings is required. A true value can be specified for <code>enumeration_allow_multiple_values</code> to allow the user to pick more than one value, but this defaults to false.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="supported_parameters()_example"
><code>supported_parameters()</code> example</a></h4>

<pre>    use Perl::Critic::Utils qw{ :characters };

    sub supported_parameters {
        return (
            {
                name               =&#62; &#39;a_single_valued_enumeration&#39;,
                description        =&#62;
                    &#39;An example enumeration that can only have a single value.&#39;,
                default_string     =&#62; $EMPTY,
                behavior           =&#62; &#39;enumeration&#39;,
                enumeration_values =&#62; [ qw{ block statement pod operator } ],
                enumeration_allow_multiple_values =&#62; 0,
            },
            {
                name               =&#62; &#39;a_multi_valued_enumeration&#39;,
                description        =&#62;
                    &#39;An example enumeration that can have multiple values.&#39;,
                default_string     =&#62; &#39;fe&#39;,
                behavior           =&#62; &#39;enumeration&#39;,
                enumeration_values =&#62; [ qw{ fe fi fo fum } ],
                enumeration_allow_multiple_values =&#62; 1,
            },
        );
    }</pre>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="Access_example"
>Access example</a></h4>

<pre>    sub violates {
        my ($self, $element, $document) = @_;

        ...
        my $single_value = $self-&#62;{_a_single_valued_enumeration};
        ...
        my $multi_value = $self-&#62;{_a_multi_valued_enumeration};
        if ( $multi_value-&#62;{fum} ) {
            ...
        }
        ...
    }</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Using_a_Custom_Parser"
>Using a Custom Parser</a></h2>

<p>If none of the behaviors does exactly what you want it to, you can provide your own parser for a parameter. The reason for doing this as opposed to using an implementation of <code>initialize_if_enabled()</code> is that it allows you to use a behavior to provide its extra functionality and it provides a means for a <code>Perl::Critic</code> configuration program, e.g. an IDE that integrates <code>Perl::Critic</code>, to validate your parameter as the user modifies its value.</p>

<p>The way you declare that you have a custom parser is to include a reference to it in the parameter specification with the <code>parser</code> key. For example:</p>

<pre>    sub supported_parameters {
        return (
            {
                name           =&#62; &#39;file_name&#39;,
                description    =&#62; &#39;A file for to read a list of values from.&#39;,
                default_string =&#62; undef,
                behavior       =&#62; &#39;string&#39;,
                parser         =&#62; \&#38;_parse_file_name,
            },
        );
    }</pre>

<p>A parser is a method on a subclass of <a href="../../Perl/Critic/Policy.html" class="podlinkpod"
>Perl::Critic::Policy</a> that takes two parameters: the <a href="../../Perl/Critic/PolicyParameter.html" class="podlinkpod"
>Perl::Critic::PolicyParameter</a> that is being specified and the value string provided by the user. The method is responsible for dealing with any default value and for saving the parsed value for later use by the <code>violates()</code> method.</p>

<p>An example parser (without enough error handling) for the above example declaration:</p>

<pre>    use File::Slurp qw&#60; slurp &#62;;

    use Perl::Critic::Exception::Configuration::Option::Policy::ParameterValue
        qw{ throw_policy_value };

    sub _parse_file_name {
        my ($self, $parameter, $config_string) = @_;

        my @thingies;

        if ($config_string) {
            if (not -r $config_string) {
                throw_policy_value
                    policy         =&#62; $self-&#62;get_short_name(),
                    option_name    =&#62; $parameter-&#62;get_name(),
                    option_value   =&#62; $config_string,
                    message_suffix =&#62; &#39;is not readable.&#39;;
            }

            @thingies = slurp $config_string;
        }

        $self-&#62;{_thingies} = \@thingies;

        return;
    }</pre>

<p>Note that, if the value for the parameter is not valid, an instance of <a href="../../Perl/Critic/Exception/Configuration/Option/Policy/ParameterValue.html" class="podlinkpod"
>Perl::Critic::Exception::Configuration::Option::Policy::ParameterValue</a> is thrown. This allows <code>Perl::Critic</code> to include that problem along with any other problems found with the user&#39;s configuration in a single error message.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Using_Both_supported_parameters()_and_initialize_if_enabled()"
>Using Both <code>supported_parameters()</code> and <code>initialize_if_enabled()</code></a></h2>

<p>There are cases where a Policy needs additional initialization beyond configuration or where the way it acts depends upon the combination of multiple parameters. In such situations, you will need to create an implementation of <code>initialize_if_enabled()</code>. If you want to take advantage of the supplied parameter handling from within implementation of <code>initialize_if_enabled()</code>, note that the information from <code>supported_parameters()</code> will already have been used, with user-supplied parameter values validated and placed into the Policy by the time <code>initialize_if_enabled()</code> has been called. It is likely that you will not need to refer the contents of the <code>$config</code> parameter; just pull the information you need out of <code>$self</code>. In fact, any value for the parameter values will be gone.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Summary_of_permitted_hash_keys_in_supported_parameters()."
>Summary of permitted hash keys in <code>supported_parameters()</code>.</a></h2>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="All_types"
>All types</a></h3>

<dl>
<dt><a name="-_&#34;name&#34;_(mandatory)"
>- &#34;name&#34; (mandatory)</a></dt>

<dd>
<dt><a name="-_&#34;description&#34;_(optional)"
>- &#34;description&#34; (optional)</a></dt>

<dd>
<dt><a name="-_&#34;behavior&#34;_(optional)"
>- &#34;behavior&#34; (optional)</a></dt>

<dd>
<p>Currently, one of:</p>

<dl>
<dt><a name="&#34;boolean&#34;"
>&#34;boolean&#34;</a></dt>

<dd>
<dt><a name="&#34;enumeration&#34;"
>&#34;enumeration&#34;</a></dt>

<dd>
<dt><a name="&#34;integer&#34;"
>&#34;integer&#34;</a></dt>

<dd>
<dt><a name="&#34;string&#34;"
>&#34;string&#34;</a></dt>

<dd>
<dt><a name="&#34;string_list&#34;"
>&#34;string list&#34;</a></dt>
</dl>

<dt><a name="-_&#34;default_string&#34;_(optional)"
>- &#34;default_string&#34; (optional)</a></dt>

<dd>
<p>A string representation of the default value of the parameter.</p>

<dt><a name="-_&#34;parser&#34;_(optional)"
>- &#34;parser&#34; (optional)</a></dt>

<dd>
<p>A code ref to a custom parser for the parameter.</p>
</dd>
</dl>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Enumerations"
>Enumerations</a></h3>

<dl>
<dt><a name="-_&#34;enumeration_values&#34;_(mandatory)"
>- &#34;enumeration_values&#34; (mandatory)</a></dt>

<dd>
<p>A mandatory reference to an array of strings.</p>

<dt><a name="-_&#34;enumeration_allow_multiple_values&#34;_(optional)"
>- &#34;enumeration_allow_multiple_values&#34; (optional)</a></dt>

<dd>
<p>Boolean indicating whether or not the user is restricted to a single value.</p>
</dd>
</dl>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Integers"
>Integers</a></h3>

<dl>
<dt><a name="-_&#34;integer_minimum&#34;_(optional)"
>- &#34;integer_minimum&#34; (optional)</a></dt>

<dd>
<p>Minimum allowed value, inclusive.</p>

<dt><a name="-_&#34;integer_maximum&#34;_(optional)"
>- &#34;integer_maximum&#34; (optional)</a></dt>

<dd>
<p>Maximum allowed value, inclusive.</p>
</dd>
</dl>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="String_lists"
>String lists</a></h3>

<dl>
<dt><a name="-_&#34;list_always_present_values&#34;_(optional)"
>- &#34;list_always_present_values&#34; (optional)</a></dt>

<dd>
<p>A reference to an array of values that should always be included in the value of the parameter.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ADDITIONAL_FEATURES"
>ADDITIONAL FEATURES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="default_maximum_violations_per_document()"
><code>default_maximum_violations_per_document()</code></a></h2>

<p>Certain problems that a Policy detects can be endemic to a particular file; if there&#39;s one violation, there&#39;s likely to be many. A good example of this is <a href="../../Perl/Critic/Policy/TestingAndDebugging/RequireUseStrict.html" class="podlinkpod"
>Perl::Critic::Policy::TestingAndDebugging::RequireUseStrict</a>; if there&#39;s one line before <a href="#use_strict" class="podlinkpod"
>&#34;use strict&#34;</a>, there&#39;s a good chance that the entire file is missing <a href="#use_strict" class="podlinkpod"
>&#34;use strict&#34;</a>. In such cases, it&#39;s not much help to the user to report every single violation. If you&#39;ve got such a policy, you should override <a href="../../Perl/Critic/Policy.html#default_maximum_violations_per_document()" class="podlinkpod"
>default_maximum_violations_per_document()</a> method to provide a limit. The user can override this value with a value for &#34;maximum_violations_per_document&#34; in their <em>.perlcriticrc</em>.</p>

<p>See the source code for <a href="../../Perl/Critic/Policy/ValuesAndExpressions/ProhibitMagicNumbers.html" class="podlinkpod"
>Perl::Critic::Policy::ValuesAndExpressions::ProhibitMagicNumbers</a> and <a href="../../Perl/Critic/Policy/TestingAndDebugging/RequireUseWarnings.html" class="podlinkpod"
>Perl::Critic::Policy::TestingAndDebugging::RequireUseWarnings</a> for examples.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_safe()"
><code>is_safe()</code></a></h2>

<p>Most <a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a> Policies are purely <i>static</i>. In other words, they never compile or execute any of the source code that they analyze. However it is possible to write <i>dynamic</i> Policies that do compile or execute code, which may result in unsafe operations (see <a href="../../Perl/Critic/Dynamic.html" class="podlinkpod"
>Perl::Critic::Dynamic</a> for an example). So the <code>is_safe()</code> method is used to indicate whether a Policy can be trusted to not cause mischief. By default, <code>is_safe()</code> returns true. But if you are writing a Policy that will compile or execute any of the source code that it analyzes, then you should override the <code>is_safe()</code> method to return false.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DISTRIBUTING_YOUR_POLICIES"
>DISTRIBUTING YOUR POLICIES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Create_a_Distribution"
>Create a Distribution</a></h2>

<p>You need to come up with a name for your set of policies. Sets of add-on policies are generally named <code>Perl::Critic::<i>something</i></code>, e.g. <a href="../../Perl/Critic/More.html" class="podlinkpod"
>Perl::Critic::More</a>.</p>

<p>The module representing the distribution will not actually have any functionality; it&#39;s just documentation and a name for users to use when installing via <a href="../../CPAN.html" class="podlinkpod"
>CPAN</a>/<a href="../../CPANPLUS.html" class="podlinkpod"
>CPANPLUS</a>. The important part is that this will include a list of the included policies, with descriptions of each.</p>

<p>A typical implementation will look like:</p>

<pre>    package Perl::Critic::Example;

    use strict;
    use warnings;

    our $VERSION = &#39;1.000000&#39;;

    1; # Magic true value required at end of module

    __END__

    =head1 NAME

    Perl::Critic::Example - Policies for Perl::Critic that act as an example.

    =head1 AFFILIATION

    This module has no functionality, but instead contains documentation
    for this distribution and acts as a means of pulling other modules
    into a bundle.  All of the Policy modules contained herein will have
    an &#34;AFFILIATION&#34; section announcing their participation in this
    grouping.


    =head1 SYNOPSIS

    Some L&#60;Perl::Critic|Perl::Critic&#62; policies that will help you keep your
    code nice and compliant.


    =head1 DESCRIPTION

    The included policies are:

    =over

    =item L&#60;Perl::Critic::Policy::Documentation::Example|Perl::Critic::Policy::Documentation::Example&#62;

    Complains about some example documentation issues.  [Default severity: 3]


    =item L&#60;Perl::Critic::Policy::Variables::Example|Perl::Critic::Policy::Variables::Example&#62;

    All modules must have at least one variable.  [Default severity: 3]


    =back


    =head1 CONFIGURATION AND ENVIRONMENT

    All policies included are in the &#34;example&#34; theme.  See the
    L&#60;Perl::Critic|Perl::Critic&#62; documentation for how to make use of this.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Themes"
>Themes</a></h2>

<p>Users can choose which policies to enable using themes. You should implement <code>default_themes()</code> so that users can take advantage of this. In particular, you should use a theme named after your distribution in all your policies; this should match the value listed in the <code>CONFIGURATION AND ENVIRONMENT</code> POD section as shown above.</p>

<pre>    default_themes { return qw&#60; example math &#62; }</pre>

<p>If you&#39;re looking for ideas of what themes to use, have a look at the output of <code>perlcritic --list-themes</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Documentation"
>Documentation</a></h2>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="AFFILIATION"
>AFFILIATION</a></h3>

<p>Since all policies have to go somewhere under the <code>Perl::Critic::Policy::</code> namespace, it isn&#39;t always clear what distribution a policy came from when browsing through their documentation. For this reason, you should include an <code>AFFILIATION</code> section in the POD for all of your policies that state where the policy comes from. For example:</p>

<pre>    =head1 AFFILIATION

    This policy is part of L&#60;Perl::Critic::Example|Perl::Critic::Example&#62;.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="CONFIGURATION"
>CONFIGURATION</a></h3>

<p>In order to make it clear what can be done with a policy, you should always include a <code>CONFIGURATION</code> section in your POD, even if it&#39;s only to say:</p>

<pre>    =head1 CONFIGURATION

    This Policy is not configurable except for the standard options.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TESTING_YOUR_POLICY"
>TESTING YOUR POLICY</a></h1>

<p>The <a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a> distribution also contains a framework for testing your Policy. See <a href="../../Test/Perl/Critic/Policy.html" class="podlinkpod"
>Test::Perl::Critic::Policy</a> for the details.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="HINT"
>HINT</a></h1>

<p>When you&#39;re trying to figure out what <a href="../../PPI.html" class="podlinkpod"
>PPI</a> is going to hand you for a chunk of code, there is a <em>tools/ppidump</em> program in the <a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a> distribution that will help you. For example, when developing the above RequireBlockGrep example, you might want to try</p>

<pre>    tools/ppidump &#39;@matches = grep /pattern/, @list;&#39;</pre>

<p>and</p>

<pre>    tools/ppidump &#39;@matches = grep { /pattern/ } @list;&#39;</pre>

<p>to see the differences between the two cases.</p>

<p>Alternatively, see the <code>ppi_dumper</code> documentation at <a href="http://search.cpan.org/dist/App-PPI-Dumper/script/ppi_dumper" class="podlinkurl"
>http://search.cpan.org/dist/App-PPI-Dumper/script/ppi_dumper</a> and the <code>PPI::Tester</code> documentation at <a href="http://search.cpan.org/dist/PPI-Tester/lib/PPI/Tester.pm" class="podlinkurl"
>http://search.cpan.org/dist/PPI-Tester/lib/PPI/Tester.pm</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<p>This is part of <a href="../../Perl/Critic.html" class="podlinkpod"
>Perl::Critic</a> version 1.115.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>Chas. Owens has a blog post about developing in-house policies at <a href="http://svok.blogspot.com/2009/09/adding-house-policies-to-perlcritic.html" class="podlinkurl"
>http://svok.blogspot.com/2009/09/adding-house-policies-to-perlcritic.html</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Jeffrey Ryan Thalhammer &#60;jeff@imaginative-software.com&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (c) 2005-2011 Imaginative Software Systems. All rights reserved.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself. The full text of this license can be found in the LICENSE file included with this module.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
